// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.12/esri/copyright.txt for details.
//>>built
define("esri/tasks/FeatureSet","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../lang ../graphic ../SpatialReference ../graphicsUtils ../geometry/jsonUtils ../symbols/jsonUtils".split(" "),function(c,h,n,r,s,t,u,v,w,d,x){c=c(null,{declaredClass:"esri.tasks.FeatureSet",constructor:function(a){if(a){h.mixin(this,a);var b=this.features,p=a.spatialReference,c=d.getGeometryType(a.geometryType),p=this.spatialReference=new v(p);this.geometryType=a.geometryType;a.fields&&(this.fields=
a.fields);n.forEach(b,function(a,g){var q=a.geometry&&a.geometry.spatialReference;b[g]=new u(c&&a.geometry?new c(a.geometry):null,a.symbol&&x.fromJson(a.symbol),a.attributes);b[g].geometry&&!q&&b[g].geometry.setSpatialReference(p)});this._hydrate()}else this.features=[]},displayFieldName:null,geometryType:null,spatialReference:null,fieldAliases:null,toJson:function(a){var b={};this.displayFieldName&&(b.displayFieldName=this.displayFieldName);this.fields&&(b.fields=this.fields);this.spatialReference?
b.spatialReference=this.spatialReference.toJson():this.features[0]&&this.features[0].geometry&&(b.spatialReference=this.features[0].geometry.spatialReference.toJson());this.features[0]&&(this.features[0].geometry&&(b.geometryType=d.getJsonType(this.features[0].geometry)),b.features=w._encodeGraphics(this.features,a));b.exceededTransferLimit=this.exceededTransferLimit;return t.fixJson(b)},_hydrate:function(){var a=this.transform;if(a){var b=this.features,c,h=a.translate[0],d=a.translate[1],g=a.scale[0],
q=a.scale[1],n=function(a,b,c){if("esriGeometryPoint"===a)return function(a){a.x=b(a.x);a.y=c(a.y)};if("esriGeometryPolyline"===a||"esriGeometryPolygon"===a)return function(a){a=a.rings||a.paths;var e,g,f,h,d,k,l,m;e=0;for(g=a.length;e<g;e++){d=a[e];f=0;for(h=d.length;f<h;f++)k=d[f],0<f?(l+=k[0],m+=k[1]):(l=k[0],m=k[1]),k[0]=b(l),k[1]=c(m)}};if("esriGeometryEnvelope"===a)return function(a){a.xmin=b(a.xmin);a.ymin=c(a.ymin);a.xmax=b(a.xmax);a.ymax=c(a.ymax)};if("esriGeometryMultipoint"===a)return function(a){a=
a.points;var e,d,f;e=0;for(d=a.length;e<d;e++)f=a[e],f[0]=b(void 0),f[1]=c(void 0)}}(this.geometryType,function(a){return a*g+h},function(a){return d-a*q}),a=0;for(c=b.length;a<c;a++)b[a].geometry&&n(b[a].geometry);this.transform=null}}});r("extend-esri")&&h.setObject("tasks.FeatureSet",c,s);return c});